---
layout: default
---

<article class="truck">
    <div class="container">
        <div class="truck__header">
            <h1 class="truck__name">{{ page.name }}</h1>
            <div class="truck__stats">
                <span class="stat">
                    <strong>{{ page.total_events }}</strong> events
                </span>
                <span class="stat">
                    Last seen: {{ page.last_seen | date: '%B %d, %Y' }}
                </span>
            </div>
        </div>
        
        <div class="truck__content">
            <div class="truck__events">
                <h2 class="truck__events-title">Upcoming Events</h2>
                
                {% assign truck_events = site.data.events | where: 'truck_name', page.name | sort: 'start_ts' %}
                {% if truck_events.size > 0 %}
                    <div class="events-list">
                        {% for event in truck_events %}
                            <div class="event-card">
                                <div class="event-card__date">
                                    <span class="date__month">{{ event.start_ts | date: '%b' }}</span>
                                    <span class="date__day">{{ event.start_ts | date: '%d' }}</span>
                                </div>
                                
                                <div class="event-card__content">
                                    <h3 class="event-card__venue">{{ event.venue }}</h3>
                                    <p class="event-card__time">
                                        {{ event.start_ts | date: '%l:%M %p' }} - {{ event.end_ts | date: '%l:%M %p' }}
                                    </p>
                                    <p class="event-card__location">
                                        ğŸ“ {{ event.raw_address }}, {{ event.city }}
                                    </p>
                                    
                                    {% if event.confidence %}
                                        <span class="event-card__confidence confidence--{{ event.confidence | downcase }}">
                                            {{ event.confidence }}
                                        </span>
                                    {% endif %}
                                </div>
                                
                                <div class="event-card__actions">
                                    <a href="{{ event.id | prepend: '/events/' | relative_url }}" 
                                       class="btn btn--small">
                                        View Details
                                    </a>
                                    <a href="https://www.google.com/maps/dir/?api=1&destination={{ event.lat }},{{ event.lng }}" 
                                       target="_blank" 
                                       class="btn btn--small btn--secondary">
                                        Directions
                                    </a>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="truck__no-events">
                        <p>No upcoming events scheduled for {{ page.name }}.</p>
                        <p>Check back soon for updates!</p>
                    </div>
                {% endif %}
            </div>
            
            <div class="truck__map-container">
                <h3 class="truck__map-title">Event Locations</h3>
                <div id="truck-map" class="truck__map"></div>
            </div>
        </div>
    </div>
</article>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize map for this truck's events
    const truckEvents = [
        {% for event in truck_events %}
        {
            lat: {{ event.lat }},
            lng: {{ event.lng }},
            venue: "{{ event.venue }}",
            time: "{{ event.start_ts | date: '%l:%M %p' }} - {{ event.end_ts | date: '%l:%M %p' }}",
            date: "{{ event.start_ts | date: '%b %d' }}",
            url: "{{ event.id | prepend: '/events/' | relative_url }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
    ];
    
    initTruckMap('truck-map', truckEvents);
});
</script>
